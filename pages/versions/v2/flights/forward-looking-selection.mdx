# Forward Looking Selection

We realize that the [Flight Selection](/versions/v2/flights/selection) process can be a bit cumbersome, especially when trying to progressively compute the different possibilities when selecting certain brands and fares. To make this process easier, we've created the Forward Looking Selection endpoints. These endpoints are designed to help you create more advanced selection flows, where you can progressively receive more granular information about the itinerary that is being selected.

## Estimate Commission

`POST /flight/[sessionId]/bound/[boundIndex]/estimate-commission`

Use this endpoint to estimate the possible the hightest and the lowest commission that can be earned from selecting a fare brand in a specific bound. This endpoint requires the [Public ID](/versions/v2/glossary#public-id) of the flight fares that had been selected in the previous steps. You may optionally include the [Public ID](/versions/v2/glossary#public-id) of the brands that had been selected in the previous steps.

### Request

```json filename="POST /flight/[sessionId]/bound/[boundIndex]/estimate-commission" copy
{
  "currentBrands": [
    "d61e1c3e-9f78-4228-befb-0e704548e164",
    "ee51db09-3bac-4b1e-b77f-4bc1cf295b75",
    "e667ed2a-9c96-49cf-a1ca-549825394cca",
    "5a9057c3-26d1-4501-812e-42d78e0d74b0",
    "311ddebd-f486-4110-89d0-04fc8256ba37"
  ],
  "selectedFare": ["fc3de66b-88ee-463d-b2d8-81f9d09969b6"],
  "selectedBrands": ["cb718a38-694c-49e0-b78a-b6ba0dc23753"]
}
```

- `currentBrands`: (`Array<`[Public ID](/versions/v2/glossary#public-id)`>`) The public ids of the brands you want to receive the commission estimate for.
- `selectedFare`: (`Array<`[Public ID](/versions/v2/glossary#public-id)`>`) The public ids of the fares selected in the previous bounds, in order (from the first bound to the current bound.)
- `selectedBrands`: (`Array<`[Public ID](/versions/v2/glossary#public-id)`>?`) The public ids of the bounds selected in the previous bounds, in order. Each of selected brands is associated with the fare of the same index in the `selectedFares` array.

### Response

```json filename="POST /flight/[sessionId]/bound/[boundIndex]/estimate-commission" copy
{
  "brands": [
    {
      "public": "0b0cf94a-dcc8-40d8-8ceb-49c6da72bcb3",
      "maximum_itinerary_price": "744.37",
      "minimum_itinerary_price": "744.37"
    },
    {
      "public": "c051f2c3-29c5-41fd-a54f-8fe3239366e0",
      "maximum_itinerary_price": "744.37",
      "minimum_itinerary_price": "744.37"
    }
  ]
}
```

- `brands`: (`Array<Record>`) The pricing and commission estimates for the brands that were passed as `currentBrands`.
  - `brands[].public` : ([Public ID](/versions/v2/glossary#public-id)) The public id of the current brand corresponding to the commission estimate.
  - `brands[].maximum_itinerary_price` : (`string`) The maximum price of the itinerary that can be achieved by selecting the brand.
  - `brands[].minimum_itinerary_price` : (`string`) The minimum price of the itinerary that can be achieved by selecting the brand.

### Possible Errors

| Status Code | Error                                                             | Reason                                                                                                                         |
| ----------- | ----------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------ |
| 400         | [Validation Error]                                                | Failed Validation                                                                                                              |
| 404         | Session not found or expired                                      | Request targeting a non-existent. session.                                                                                     |
| 400         | Invalid bound                                                     | The bound that the request is asking for is exceeding the number of bounds in this session.                                    |
| 400         | Selected fares or bounds are not applicable for the first bound | The bound index is 0, but the `selectedFare` and/or the `selectedBrand` are not empty.                                         |
| 400         | Number of selected entities must correspond to the bound index    | The number of items in the `selectedFare` or `selectedBrand` arrays are not corresponding to the bound the in the request URL. |
| 400         | Selected entities must represent consecutive bounds.              | The items in the `selectedFare` array are not corresponding to consecutive bounds, in order.                                   |

## Matching Fares

`POST /flight/[sessionId]/bound/[boundIndex]/matching`

Use this endpoint to get an array of fares that could be matched with the selected fare(s) and their associated brand that may be compatible with the brands associated with the selected fare(s).   

### Request

```json filename="POST /flight/[sessionId]/bound/[boundIndex]/matching" copy
{
  "selectedFares" : ["0d7612e6-e4b4-4f38-9c90-af1993dea405"]
}
```

- `selectedFare`: (`Array<`[Public ID](/versions/v2/glossary#public-id)`>`) The public ids of the fares selected in the previous bounds, in order (from the first bound to the current bound.)

### Response

```json filename="POST /flight/[sessionId]/bound/[boundIndex]/matching" copy
{
    "fares": [
        {
            "public": "7ea4a4d2-69fc-4e54-9055-613bb0b4dd45",
            "brands": [
                "748668ee-c05f-4991-88b5-47191d4f5447",
                "ed2f8530-d000-4570-8df6-410c720a008e",
                "8ae2323a-d885-42ec-91b3-96cf7fe13688",
                "591371cf-958a-49cc-9cd1-376f9667ee79",
                "f5b44608-75e1-49a4-9cfc-671edf0636db",
                "eb598f99-04ed-474d-b251-94740c8d89cb",
                "ec131643-b7b5-46de-80bb-c1e83dbbf83e",
                "8f59a646-71f6-4cc1-b2ef-d33fbda6abc3",
                "d1dc60c4-0af3-472f-a829-71c360a06bac"
            ]
        },
        {
            "public": "1ccea29d-7292-4f97-acf0-5e1cfa0bc201",
            "brands": [
                "23277a6b-8a38-4457-8955-dbd9ef13f723",
                "9213f5ad-b051-479e-93b6-1991b6ea1149",
                "ff6714ab-66c0-4a1f-8a8e-c55e4b8cfe12",
                "c448b01d-c2bb-4df5-81c5-0953c3bf182a",
                "ac837779-246a-49ef-8683-ca9a9850a5c0",
                "92894edd-52b3-4ac1-aa66-a9e847bfe89f",
                "0fa498c1-b120-469d-b670-c208a4ae182f",
                "3bd5b36d-2969-477f-87fe-99df266a6a7a",
                "63d57be1-c5b8-4166-be13-471095f05c0c"
            ]
        },
        {
            "public": "27c90c56-2736-4ae2-87b4-09de17d4f29c",
            "brands": [
                "0924b0ff-f57c-4360-8d52-445f2b3b4b8f",
                "a5bcda0d-c93b-45bc-8397-a3cba7238025",
                "1755b17a-e68e-4f31-bb7c-6a2fb7082ff8",
                "5118a68f-a005-4310-9ef1-cd92f2c4118f",
                "bf63ed9b-449e-493d-a92b-d3822a160f77",
                "687fb727-15fa-4388-9eb0-59d622ae405a",
                "d9fca9bb-1ca9-448b-8902-f57992880cee",
                "56ce30cb-c347-4e87-aa0a-c03ea55196e6",
                "53c62853-51a3-471b-9cbc-716f018200d8"
            ]
        },
        {
            "public": "8819d63d-d9b8-4dae-9b6f-5a5190acf4e0",
            "brands": [
                "51e49946-0f30-4469-8421-cdf843160534",
                "70941673-ced9-47f4-a235-2ad48caecfbc",
                "22067b35-ae7f-41ca-9a65-62b32d448e34",
                "7a5fde87-818d-44d9-ad9f-59713464fb17",
                "45f58a83-9089-4298-85a0-a9f9b90a8f7d",
                "c369f5e0-a613-41a1-b7b7-fa3c45f48046",
                "237b9217-a53e-48a7-ad3e-26add04b2b27",
                "d0b26779-8f7a-49f1-80c5-76922b31ad3a",
                "1f0b4b82-49f1-41d9-8eb4-9bcce7fd9bb8"
            ]
        },
        {
            "public": "0239546b-bc0d-4fcf-a9b2-37cc8ed2dcb1",
            "brands": [
                "8846f0a6-9a7b-4782-838c-50045d0bc7b0",
                "3e504b11-16d7-45b9-af28-33a97ac3352e",
                "2e5ebb30-7a72-428c-8f51-09b58f5b172f",
                "c554d815-aa07-4fd4-aa31-adb0b8e8271e",
                "1a634ddd-d7c0-4e36-8df7-f844d98ad24f",
                "f6475fd9-65df-422d-917c-81e4d81a8d58",
                "18429eaf-d490-4217-a9d1-8090d77f846a",
                "3f5b093e-1438-4166-b154-564baf6ee9e0",
                "5ecf005e-c465-4904-ae14-800d23572c19"
            ]
        },
        {
            "public": "6c1270c7-0870-4f01-b1f6-a69be1798a91",
            "brands": [
                "ca51f035-448e-4049-b1e7-ed936d24bc22",
                "ca42e1cd-495a-4c08-a589-184bd2ff7728",
                "deeb9bae-d17b-42a7-9549-5ee97925b4ca",
                "b9e79f87-8c8a-4197-bb04-3f702b56c645",
                "381bd7cd-28c4-4fe9-a7bc-99ccc801035a",
                "13be1e18-664c-46fe-b8bb-adbcb31b8d5f",
                "f6026ac2-8c04-4f21-94fd-d1446931c9fc"
            ]
        },
        {
            "public": "49d603c6-6521-4390-84ed-e5a8ea11c3f9",
            "brands": [
                "922921ab-6738-48bd-b2be-84950d77109e",
                "16029436-345d-4af6-a53f-941a62db135e",
                "a27426a2-af1c-4e80-89e9-8a71600a86c2",
                "fb2e2888-9631-4cc6-85f2-a700eeb90732",
                "93f5dc19-ed03-4d90-b8e9-afd8e2ff7221",
                "a1a4be4e-4c99-40a9-a736-feadbd4dc4e9",
                "e0d4f4b2-ecb9-4455-875b-6297639afbe1"
            ]
        },
        {
            "public": "e855b235-1b0c-4ac8-b27d-71b2d5163608",
            "brands": [
                "16e568dd-1e3b-4a2c-879e-f66ab3b905cd",
                "a25dfb6d-77b6-4b8d-ba78-0a99f4cee272",
                "98bed228-4492-4809-bed0-4ea8efb6bbea",
                "dd8071f3-f604-47f4-9e66-d283c2697c0c",
                "130be27a-5c51-458c-b90a-223a9d43086c",
                "c5192deb-2327-4b81-a209-d58b4e035679",
                "f224c2bb-4d25-4d4f-827e-f564cfdd9ffc"
            ]
        },
        {
            "public": "4ecc53d9-dc31-4416-b218-64d6bfed7c95",
            "brands": [
                "6ca83dea-681e-42c5-a7ac-a7ec848c216b",
                "0253fc6a-fb3d-4bee-8df9-8356e33edb2c",
                "f1ce178c-7d86-4213-868a-274cfe8d8c20",
                "2fa77742-f9ec-48ef-bcb2-6e4c1718643a",
                "b60c4150-2b84-4549-996e-9cc53867e3c7",
                "6436d8fa-6e70-4808-bf85-18e117ce9a8b",
                "7ead93be-d97b-4768-9a97-071a0e1817c7"
            ]
        },
        {
            "public": "397b883b-7021-4a6a-b000-f7a61ff117e3",
            "brands": [
                "57f92c58-7c48-41c4-b9c4-b1399693d318",
                "e12650d5-6364-48b2-9711-b18f699e0868",
                "25fe43b8-6ddc-400a-839e-18b484640ac4",
                "0eca6312-eb20-4910-bacf-8f151e064346",
                "7f9c52fe-01fc-4026-bc37-17cf3fc20464",
                "9b46d236-37bb-4c9a-8fe2-96ee22760e94",
                "85bc4ca1-5a63-4d85-b65e-ee9ee73e1477"
            ]
        },
        {
            "public": "60259f86-df61-4000-b8fd-76591cb7afc1",
            "brands": [
                "b9706715-7385-476f-bd8a-5b078d61823c",
                "bac6f87b-5070-43b8-9e54-106ae833bb2e",
                "b82630fc-181f-48ab-913d-6e7a62eb7e40",
                "69deb3f2-8e9d-41e0-8280-0b1c1d7ffc22",
                "501583c0-26fc-47b1-ba1c-8398df735071",
                "a5c47c90-5e14-45aa-9e52-e547e8841b12",
                "a7c8c6af-70f8-4064-b5e8-39d4795b350f"
            ]
        },
        {
            "public": "9198b909-9a86-45cc-8960-fbf03fbb5b4b",
            "brands": [
                "5ca6067a-753b-4602-a4ce-4cdaab9f813f",
                "30c895e8-85d3-4223-a140-0e16fd293258",
                "6f76f5fa-8e69-4213-9b1c-20423323817c",
                "7e2063c4-765f-43a1-a0c2-c64c156d62fa",
                "1378e42b-eb5d-498d-923e-bda03f159314",
                "89fa3375-89b6-4405-b8ed-bd724ca03a65",
                "2198e083-5f80-442a-9ce7-f53ecba6124d"
            ]
        },
        {
            "public": "63a12448-64c4-481c-a15e-0cc71a823d19",
            "brands": [
                "0bcf232f-b428-4b8d-a390-8fd60cbf0949",
                "bc75e642-8ec4-4280-a8aa-32760ce3f297",
                "591eaccd-b9bf-45d5-b06f-bce60229af8a",
                "615e35a4-1d7b-40dc-bba2-6b0af3db4040",
                "826b227f-6100-411f-9940-77e5c29c0781",
                "30dd0833-0701-43cb-bb87-6e02f70e460e",
                "07e727a3-1cff-4da6-9161-530c45c7070a"
            ]
        },
        {
            "public": "f6c479ec-26a4-4291-b6f7-0ba67169ec48",
            "brands": [
                "58797de0-5972-4c76-861a-1855edc32e20",
                "158570a3-3879-40ba-ad41-9d5d242c3fd2",
                "4c6a7081-17f0-4e7b-aa80-eee1189f14f2",
                "101568ae-3ede-4fea-9d62-abe238b73097",
                "e95d1474-3c56-4fac-8f40-c30571920cec",
                "2ef2790c-23e5-4b93-b5a5-9ef555d53aab",
                "22796569-13cf-421e-b252-dcaf19526819"
            ]
        },
        {
            "public": "3e271e93-f1da-4b35-b667-d4d47986705f",
            "brands": [
                "f4e8c25e-286a-43e2-b9f6-8f61e443dc45",
                "87af0570-64d4-4668-984a-6f6dc2bce17d",
                "628c0289-d600-4aa5-bbbd-ce3966120add",
                "cddefc49-c14b-48ac-89fd-74df66bf28b7",
                "27d5ca11-507f-4b8f-ac8b-34ae1e6b7409",
                "06a37e8e-1080-4389-ac97-b9712e18113b",
                "a3f1349d-606f-4f51-8795-55e3f1cd21e2"
            ]
        },
        {
            "public": "6036f4c7-8acd-40c2-b35f-7c22125fe430",
            "brands": [
                "1d58f250-42ad-4cfa-9a4a-3b2c8bac5df2",
                "22fbefe8-e07b-4c3d-8cde-541549f3acf1",
                "dd9d3b91-54eb-4267-8bc5-eceedd69686b",
                "45148d5d-824b-4d5b-9227-acbb338c0c02",
                "0389e506-c0ac-43d7-93a7-0a54d044a35e",
                "690dda7c-2153-4911-8c3c-39745cd0f503",
                "e52d481a-fcd8-441f-baef-6987b73f2509"
            ]
        },
        {
            "public": "b4b8abea-fa9e-4f4c-aaa9-07560fe8d96d",
            "brands": [
                "f3bcbeee-307c-4aa2-9ce3-0e8ef36af88f",
                "9ccf8318-e5c8-4581-8abd-0c7e893890fe",
                "e460b064-5205-422f-9d5f-af7841906ed4",
                "115a4f2b-5ac8-4824-af85-56fc404222cf",
                "d0ed970e-c5ef-4024-9e4c-05892e243883",
                "662a3649-9c46-491d-81e7-c04ece819ddb",
                "d61003db-e245-4a9a-97d5-bae45b70ef94"
            ]
        },
        {
            "public": "169860c4-6924-439f-bb2a-1166d4233c5f",
            "brands": [
                "929b8a70-0eb1-4988-9966-d8458dcf4b3f",
                "4ff83066-4693-4230-a7a2-f20024e27bc4",
                "5a953127-deb2-4700-9ac2-fd84e4a5edbc",
                "f6284d92-e0b8-443f-ac6d-f78989b5b6a9",
                "2cb411f9-cc6b-4374-8c1d-4e8475a11f7f",
                "3575792b-1766-4a27-9183-0685a33ca24c",
                "b24d8a84-d9d8-413d-813d-83eef91f0735"
            ]
        },
        {
            "public": "6270fb02-88b6-4cfc-a8c4-9e6ebb685543",
            "brands": [
                "dfb2776f-ad1b-48b3-b853-31de234bfc8f",
                "6c018190-2b00-4afc-ad23-033bd4884a68",
                "ca6c7664-d3c8-4b74-b811-30a6a732ce93",
                "f8f7cbcc-df85-4c7f-8c99-5f404bd57202",
                "bb80e16e-14f4-41b9-bd74-331bbb7159ae",
                "4c19f315-c523-441f-9ac1-ca36a352acd1",
                "d1c1bc4e-0183-4afa-8279-51b999fc4bc6"
            ]
        },
        {
            "public": "3824c345-0286-4c3c-9a17-7f90e9349eb9",
            "brands": [
                "0b9974bd-086c-4f68-934c-2fb6ba5a9b65",
                "6a5a54fc-b5fe-4550-a534-b1f4f9eea0dd",
                "4a5fea2a-aa28-483b-967a-94414c0be23a",
                "63889f5a-9deb-41f5-bfbf-953206173512",
                "0aa2d161-3b9a-4fc9-979a-0550c0a9ae14",
                "000bfa1e-e1f0-40f6-bb75-9a1a85f308b3",
                "fd9c50c0-525a-4329-82d1-f8c5bc3deaab"
            ]
        }
    ]
}
```

- `fares`: (`Array<Record>`) The array representing the fares that could be matched with the selected fare(s) in the immidiate next bound.
  - `fares[].public` : ([Public ID](/versions/v2/glossary#public-id)) The public id of the fare matched with the given already-selected fare(s).
  - `brands[].brands` : (`Array<`[Public ID](/versions/v2/glossary#public-id)`>`) The public ids of the brands that are associated with the fare and may also be compatible with the brands associated with the selected fare(s). 

### Possible Errors

| Status Code | Error                                                             | Reason                                                                                                                         |
| ----------- | ----------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------ |
| 400         | [Validation Error]                                                | Failed Validation                                                                                                              |
| 404         | Session not found or expired                                      | Request targeting a non-existent. session.                                                                                     |
| 400         | Invalid bound                                                     | The bound that the request is asking for is exceeding the number of bounds in this session.                                    |
| 400         | Selected fares or bounds are not applicable for the first bound | The bound index is 0, but the `selectedFare` and/or the `selectedBrand` are not empty.                                         |
| 400         | Number of selected entities must correspond to the bound index    | The number of items in the `selectedFare` or `selectedBrand` arrays are not corresponding to the bound the in the request URL. |
| 400         | Selected entities must represent consecutive bounds.              | The items in the `selectedFare` array are not corresponding to consecutive bounds, in order.                                   |
